(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{487:function(t,e,n){var content=n(563);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(51).default)("d0d5df3e",content,!0,{sourceMap:!1})},489:function(t,e,n){var content=n(586);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(51).default)("4aea2ed8",content,!0,{sourceMap:!1})},490:function(t,e,n){var content=n(588);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(51).default)("09a926d4",content,!0,{sourceMap:!1})},562:function(t,e,n){"use strict";n(487)},563:function(t,e,n){var r=n(50)((function(i){return i[1]}));r.push([t.i,'.toolbar[data-v-4ddfffc0]{\n  background-color:#cfd8dc;\n  max-height:40px\n}\n.wrap[data-v-4ddfffc0]{\n  min-height:500px\n}\n.v-card[data-v-4ddfffc0]{\n  border:0;\n  height:inherit\n}\n.card[data-v-4ddfffc0]{\n  display:flex\n}\n.balance[data-v-4ddfffc0]{\n  width:42px;\n  height:42px;\n  flex:none\n}\n.provider-select[data-v-4ddfffc0]{\n  max-width:140px;\n  width:100%\n}\n.group-select[data-v-4ddfffc0]{\n  max-width:218px\n}\n.messages[data-v-4ddfffc0]{\n  width:45px;\n  height:45px\n}\n.output-wrap[data-v-4ddfffc0]{\n  height:200px\n}\n.output[data-v-4ddfffc0]{\n  height:auto;\n  min-height:-webkit-fill-available\n}\n.output-overflow-wrap[data-v-4ddfffc0]{\n  overflow-y:auto\n}\n.output-lg-wrap[data-v-4ddfffc0]{\n  height:70vh\n}\n.small-input[data-v-4ddfffc0]{\n  max-width:105px\n}\n.fullscreen[data-v-4ddfffc0]{\n  position:absolute!important;\n  right:24px\n}\n.attention[data-v-4ddfffc0]{\n  max-width:220px\n}\n.content[data-v-4ddfffc0]{\n  height:100%;\n  width:500px\n}\n.pin-wrap[data-v-4ddfffc0]{\n  margin-top:85px\n}\n.port-color[data-v-4ddfffc0]{\n  cursor:"pointer";\n  height:30px;\n  width:30px;\n  margin-left:10px;\n  border-radius:4px;\n  transition:border-radius .2s ease-in-out;\n  margin-right:10px\n}\n.disabled[data-v-4ddfffc0]{\n  opacity:.7;\n  pointer-events:none\n}\n.v-progress-linear[data-v-4ddfffc0]{\n  position:absolute;\n  z-index:3;\n  top:38px\n}\n.element-group[data-v-4ddfffc0]{\n  max-width:-webkit-fit-content;\n  max-width:-moz-fit-content;\n  max-width:fit-content\n}\n.hidden[data-v-4ddfffc0]{\n  display:none\n}\n.theme--dark.v-icon.v-icon.v-icon--disabled[data-v-4ddfffc0]{\n  color:#ababab!important\n}\n.imei-select[data-v-4ddfffc0]{\n  margin-top:0!important;\n  padding-top:0!important\n}',""]),r.locals={},t.exports=r},585:function(t,e,n){"use strict";n(489)},586:function(t,e,n){var r=n(50)((function(i){return i[1]}));r.push([t.i,".hidden[data-v-527ae29a]{\n  display:none\n}",""]),r.locals={},t.exports=r},587:function(t,e,n){"use strict";n(490)},588:function(t,e,n){var r=n(50)((function(i){return i[1]}));r.push([t.i,".avatar[data-v-3f7bea02]{\n  width:48px;\n  height:48px\n}\n.search[data-v-3f7bea02]{\n  max-width:300px\n}\n.hidden[data-v-3f7bea02]{\n  display:none\n}\n.speed-input[data-v-3f7bea02]{\n  max-width:200px\n}\n.count-input[data-v-3f7bea02]{\n  max-width:225px\n}",""]),r.locals={},t.exports=r},611:function(t,e,n){"use strict";n.r(e);var r=n(1),o=n(9),c=n(21),l=(n(40),n(62),n(314),n(23),n(129),n(61),n(60),n(15),n(52),n(53),n(25),n(86),n(34),n(127),n(33),n(69)),d={name:"card",props:{disabledForAction:{default:function(){return!1}},imeis:{default:function(){return[]}},port:{default:function(){return Object.assign({},this.$defaultPort)}},answer:{default:function(){return""}}},mounted:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.isGsm7=t.port.gsm7,t.isAnonymous=t.port.isAnonymous;case 2:case"end":return e.stop()}}),e)})))()},data:function(){return{outputDialog:!1,settingsDialog:!1,messagesDialog:!1,isGsm7:!1,attrs:null,on:!1,color:null,localAnswer:"",isAnonymous:!1,atCommand:null,selectedImei:null,uiUtilsModule:l.a,pinValidation:l.a.pinValidation}},methods:{attachPort:function(){this.selectedImei&&(this.port.imei=this.selectedImei,this.$emit("attach-port",this.selectedImei),this.port.answers=[],this.updateUI())},unattachPort:function(){if(this.port.imei){var t=this.port.imei;this.selectedImei=null,this.port.providerGroups=[],this.$emit("unattach-port",t),this.updateUI()}},changeProvider:function(){this.$emit("save-port")},changeGroup:function(){this.$emit("save-port")},openSettings:function(){this.color=this.port.color,this.isAnonymous=this.port.isAnonymous,this.settingsDialog=!0},saveSettings:function(){this.port.color=this.color,this.port.isAnonymous=this.isAnonymous,this.$emit("save-port"),this.settingsDialog=!1},atCommandClick:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.port.uiAtCommand=t.atCommand.trim(),t.$emit("ui-send-at");case 2:case"end":return e.stop()}}),e)})))()},listSms:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.$emit("sms-list"),setTimeout((function(){t.messagesDialog=!0}),500);case 2:case"end":return e.stop()}}),e)})))()},elementsGroups:function(){var t=this;if(!(this.port.currentGroup&&this.port.currentGroup.elements&&this.groups()))return[];try{var e=this.groups().map((function(g){return g.groupName})),n=this.port.currentGroup.elements.filter((function(t){return e.includes(t.elementName)}));return n?(n.forEach((function(e){var n=t.groups().find((function(g){return g.groupName==e.elementName}));n&&(e.groupId=n.groupId)})),n):[]}catch(t){return[]}},updateUI:function(){this.localAnswer=Math.random()},disabled:function(){return!this.port.connected||this.disabledForAction||this.port.loading||!this.port.networkFound&&!this.port.isPinRequired},disabledAction:function(){return this.disabledForAction||this.port.isBalanceChecking||this.port.groupPending||this.port.atFromUiPending},groups:function(){var t,e=this,n=null===(t=this.port.providerGroups)||void 0===t?void 0:t.find((function(p){return p.providerId==e.port.selectedProviderId}));return n?n.groups:[]}},computed:{isAdmin:function(){return this.$store.state.isAdmin}},beforeDestroy:function(){}},m=(n(562),n(63)),v=n(130),f=n.n(v),h=n(491),_=n(474),k=n(429),w=n(605),x=n(612),C=n(617),S=n(482),I=n(467),y=n(483),P=n(469),$=n(610),A=n(607),E=n(608),R=n(600),D=n(609),component=Object(m.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"h-full relative wrap"},[t.port.loading?n("v-progress-linear",{attrs:{indeterminate:"",color:"primary"}}):t._e(),t._v(" "),n("v-card",{staticClass:"flex flex-col justify-between h-full card",attrs:{color:t.port.isPinRequired?"grey lighten-3":"white"}},[n("div",{staticClass:"toolbar py-2 px-3 flex justify-between items-center"},[n("div",{staticClass:"flex items-center justify-start gap-2"},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("div",t._g(t._b({staticClass:"w-5 h-5 rounded",attrs:{green:t.port.connected&&!t.port.closed,red:!t.port.connected||t.port.closed}},"div",o,!1),r))]}}])},[t._v(" "),n("span",[t._v(" port connection status ")])]),t._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("div",t._g(t._b({staticClass:"w-5 h-5 rounded",attrs:{green:!!t.port.simCardNumber,red:!t.port.simCardNumber}},"div",o,!1),r))]}}])},[t._v(" "),n("span",[t._v(" sim card number found status ")])]),t._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("div",t._g(t._b({staticClass:"w-5 h-5 rounded",attrs:{green:t.port.networkFound,red:!t.port.networkFound&&!t.port.networkSearchPause,yellow:t.port.networkSearchPause}},"div",o,!1),r))]}}])},[t._v(" "),n("span",[t._v(" network status ")])]),t._v(" "),t.port.searchingNetwork?n("span",{staticClass:"ml-2"},[t._v("\n          Searching for network...\n        ")]):t._e()],1),t._v(" "),n("div",{staticClass:"flex justify-end gap-1"},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-icon",t._g(t._b({staticClass:"ml-1 cursor-pointer",attrs:{color:"accent",dark:"",disabled:!t.port.imei},on:{click:function(e){return t.openSettings()}}},"v-icon",o,!1),r),[t._v("\n              mdi-cog")])]}}])},[t._v(" "),n("span",[t._v(" settings ")])]),t._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-icon",t._g(t._b({staticClass:"ml-1 cursor-pointer",attrs:{color:"accent",dark:""},on:{click:function(e){return t.$emit("remove-window")}}},"v-icon",o,!1),r),[t._v("\n              mdi-close")])]}}])},[t._v(" "),n("span",[t._v(" remove window ")])])],1)]),t._v(" "),n("div",{staticClass:"content p-3"},[t.port.isPinRequired?t._e():n("div",[n("div",{staticClass:"mb-2 flex justify-start align-middle gap-2"},[n("div",{staticClass:"ml-2"},[n("b",[t._v("imei:")])]),t._v(" "),t.port.imei?t._e():n("v-select",{staticClass:"imei-select",attrs:{items:t.imeis,label:"",disabled:null!=t.port.imei&&null!=t.port.imei},model:{value:t.selectedImei,callback:function(e){t.selectedImei=e},expression:"selectedImei"}}),t._v(" "),t.port.imei?n("div",[t._v("\n            "+t._s(t.port.imei)+"\n          ")]):t._e(),t._v(" "),n("div",[t.port.imei?t._e():n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-icon",t._g(t._b({staticClass:"ml-1 cursor-pointer",attrs:{color:"accent",dark:"",disabled:!t.selectedImei},on:{click:function(e){return t.attachPort()}}},"v-icon",o,!1),r),[t._v("\n                  mdi-lock")])]}}],null,!1,452005746)},[t._v(" "),n("span",[t._v(" attach selected imei to this window ")])]),t._v(" "),t.port.imei?n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-icon",t._g(t._b({staticClass:"ml-1 cursor-pointer",attrs:{color:"accent",dark:"",disabled:t.port.groupPending},on:{click:function(e){return t.unattachPort()}}},"v-icon",o,!1),r),[t._v("\n                  mdi-lock-open")])]}}],null,!1,446510311)},[t._v(" "),n("span",[t._v(" unattach selected imei from this window ")])]):t._e()],1)],1),t._v(" "),n("div",{staticClass:"flex justify-between mb-2"},[n("div",{staticClass:"m-2"},[n("div",[n("b",[t._v("sim card number: ")]),t._v(" "+t._s(t.port.simCardNumber))]),t._v(" "),n("v-checkbox",t._g(t._b({attrs:{label:"run group after balance first check"},on:{change:function(e){return t.$emit("save-port")}},model:{value:t.port.isAutoRunGroup,callback:function(e){t.$set(t.port,"isAutoRunGroup",e)},expression:"port.isAutoRunGroup"}},"v-checkbox",t.attrs,!1),t.on))],1),t._v(" "),n("div",[n("div",{staticClass:"flex justify-end items-center"},[t.port.currentBalance?n("div",{staticClass:"flex justify-center mr-2"},[n("b",[t._v(" "+t._s(t.port.currentBalance))])]):t._e(),t._v(" "),n("div",{staticClass:"\n                  balance\n                  m-2\n                  bg-gray-100\n                  shadow-md\n                  rounded-full\n                  p-1\n                  flex\n                  justify-center\n                  items-center\n                "},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-icon",t._g(t._b({staticClass:"cursor-pointer",attrs:{color:"accent",dark:"",disabled:t.disabledAction()||t.disabled()},on:{click:function(e){return t.$emit("check-balance")}}},"v-icon",o,!1),r),[t._v("\n                      mdi-currency-usd")])]}}],null,!1,1706055996)},[t._v(" "),n("span",[t._v(" check balance ")])])],1)]),t._v(" "),n("div",{staticClass:"flex justify-end items-center"},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-icon",t._g(t._b({staticClass:"cursor-pointer",attrs:{color:"accent",dark:""}},"v-icon",o,!1),r),[t._v("\n                    mdi-information")])]}}],null,!1,4203667135)},[t._v(" "),n("span",[t._v("you will not be allowed to top up the balance more than\n                  this limit\n                ")])]),t._v(" "),n("v-text-field",{staticClass:"ml-2 small-input",attrs:{type:"number",label:"balance limit"},on:{change:function(e){return t.$emit("save-port")}},model:{value:t.port.maxBalance,callback:function(e){t.$set(t.port,"maxBalance",e)},expression:"port.maxBalance"}})],1)])]),t._v(" "),t.isAdmin?n("div",{staticClass:"flex items-center justify-start mb-2"},[n("v-text-field",{staticClass:"at-input m-2",attrs:{label:"at command",disabled:t.disabledForAction},model:{value:t.atCommand,callback:function(e){t.atCommand=e},expression:"atCommand"}}),t._v(" "),n("v-btn",{staticClass:"ml-2",attrs:{color:"accent",disabled:t.disabledAction()||!t.atCommand},on:{click:function(e){return t.atCommandClick()}}},[t._v("Send AT\n          ")])],1):t._e(),t._v(" "),n("div",{staticClass:"flex items-center justify-start mb-2"},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-icon",t._g(t._b({staticClass:"mr-2 cursor-pointer",attrs:{color:"accent",dark:""},on:{click:function(e){return t.$emit("refresh-groups")}}},"v-icon",o,!1),r),[t._v("\n                mdi-refresh")])]}}],null,!1,3852544320)},[t._v(" "),n("span",[t._v(" refresh groups list ")])]),t._v(" "),n("v-select",{staticClass:"mr-3 provider-select",attrs:{items:t.port.providerGroups,label:"Select provider","item-text":"providerName","item-value":"providerId"},on:{change:function(e){return t.changeProvider()}},model:{value:t.port.selectedProviderId,callback:function(e){t.$set(t.port,"selectedProviderId",e)},expression:"port.selectedProviderId"}}),t._v(" "),n("v-select",{staticClass:"group-select",attrs:{items:t.groups(),label:"Select group","item-text":"groupName","item-value":"groupId"},on:{change:function(e){return t.changeGroup()}},model:{value:t.port.selectedGroupId,callback:function(e){t.$set(t.port,"selectedGroupId",e)},expression:"port.selectedGroupId"}}),t._v(" "),n("v-btn",{staticClass:"ml-2",attrs:{color:"accent",disabled:t.disabledAction()||!t.port.selectedGroupId||t.disabled()},on:{click:function(e){return t.$emit("run-group",{groupId:t.port.selectedGroupId,isSubgroup:!1})}}},[t._v("Run\n          ")])],1),t._v(" "),t.port.currentGroup&&t.port.currentGroup.elements&&t.elementsGroups()&&t.elementsGroups().length>0?n("div",{class:{disabled:t.disabled()}},[n("v-divider"),t._v(" "),n("div",{staticClass:"my-2 font-bold"},[t._v("Current group subgroups:")]),t._v(" "),n("div",{staticClass:"flex flex-wrap justify-start items-center gap-2 mb-3"},t._l(t.elementsGroups(),(function(e){return n("div",{key:e.elementId,staticClass:"\n                rounded-md\n                border-gray-200 border border-solid\n                p-2\n                flex\n                items-center\n                justify-between\n                gap-1\n                element-group\n              "},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(r){var o=r.on,c=r.attrs;return[n("v-icon",t._g(t._b({attrs:{color:t.uiUtilsModule.getColorByStatus(e.status)}},"v-icon",c,!1),o),[t._v("\n                    "+t._s(t.uiUtilsModule.getIconByStatus(e.status))+"\n                  ")])]}}],null,!0)},[t._v(" "),n("span",[t._v(" "+t._s(e.status)+" ")])]),t._v(" "),n("div",[t._v(t._s(e.elementName))]),t._v(" "),"success"!=e.status&&"not started"!=e.status&&"pending"!=e.status?n("v-icon",{staticClass:"cursor-pointer",attrs:{disabled:t.disabledAction(),color:"primary"},on:{click:function(n){return t.$emit("run-group",{groupId:e.groupId,isSubgroup:!0})}}},[t._v("\n                mdi-play\n              ")]):t._e()],1)})),0)],1):t._e(),t._v(" "),n("div",{staticClass:"mb-3 relative"},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-icon",t._g(t._b({staticClass:"fullscreen cursor-pointer top-2 z-20",attrs:{color:"white",dark:""},on:{click:function(e){t.outputDialog=!0}}},"v-icon",o,!1),r),[t._v("\n                mdi-fullscreen")])]}}],null,!1,2741471583)},[t._v(" "),n("span",[t._v(" fullscreen ")])]),t._v(" "),n("div",{staticClass:"relative output-wrap output-overflow-wrap",attrs:{id:"log-window-"+t.port.id}},[n("div",{staticClass:"output w-full h-full bg-gray-400 z-10 rounded-md"},[n("div",{staticClass:"p-2 flex flex-col top-0 text-white pr-8"},t._l(t.port.answers,(function(e,r){return n("div",{key:r,staticClass:"mb-1"},[n("span",{style:{color:e.color?e.color:"white"}},[e.date?n("span",[t._v(t._s(e.date))]):t._e(),t._v(t._s(e.text))])])})),0)])])],1),t._v(" "),n("div",{staticClass:"flex justify-between items-center"},[n("div",[n("div",{staticClass:"\n                messages\n                bg-gray-100\n                shadow-md\n                rounded-full\n                p-1\n                flex\n                justify-center\n                items-center\n              "},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-icon",t._g(t._b({staticClass:"cursor-pointer",attrs:{color:"accent",dark:"",disabled:t.disabled()||t.disabledAction()},on:{click:function(e){return t.listSms()}}},"v-icon",o,!1),r),[t._v("\n                    mdi-email")])]}}],null,!1,48272875)},[t._v(" "),n("span",[t._v("list of inbox messages ")])])],1)]),t._v(" "),n("div",{staticClass:"flex flex-col justify-end items-end"},[n("div",{staticClass:"flex justify-end items-center"},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-icon",t._g(t._b({staticClass:"cursor-pointer",attrs:{color:"accent",dark:""}},"v-icon",o,!1),r),[t._v("\n                    mdi-information")])]}}],null,!1,4203667135)},[t._v(" "),n("span",[t._v("this pincode will be used next time in case of pin is\n                  required\n                ")])]),t._v(" "),n("v-text-field",{staticClass:"ml-2 small-input",attrs:{label:"pincode",rules:[t.pinValidation]},on:{change:function(e){return t.$emit("save-port")}},model:{value:t.port.pincode,callback:function(e){t.$set(t.port,"pincode",e)},expression:"port.pincode"}})],1)])])]),t._v(" "),t.port.isPinRequired?n("div",{class:{disabled:t.disabled()}},[n("div",{staticClass:"flex justify-between mb-2"},[n("div",{staticClass:"m-2"},[n("div",{staticClass:"mb-2"},[n("b",[t._v("imei:")]),t._v(" "+t._s(t.port.imei))]),t._v(" "),n("div",[n("b",[t._v("sim card number: ")]),t._v(" "+t._s(t.port.simCardNumber))])])]),t._v(" "),n("div",{staticClass:"flex flex-col justify-center items-center pin-wrap"},[n("div",{staticClass:"flex justify-center items-center mb-2"},[n("v-text-field",{staticClass:"ml-2 small-input",attrs:{outlined:"",label:"input PIN","hide-details":"",rules:[t.pinValidation],disabled:t.port.numOfPinTries<2},model:{value:t.port.pincode,callback:function(e){t.$set(t.port,"pincode",e)},expression:"port.pincode"}}),t._v(" "),n("v-btn",{staticClass:"ml-2",attrs:{disabled:t.port.numOfPinTries<2,color:"accent"},on:{click:function(e){return t.$emit("check-pin")}}},[t._v("\n              Check\n            ")])],1),t._v(" "),t.port.numOfPinTries>=2?n("div",{staticClass:"text-red-700 attention text-center"},[t._v("\n            "+t._s(t.port.numOfPinTries)+" tries left! After 1 try left the option\n            will be blocked\n          ")]):t._e(),t._v(" "),t.port.numOfPinTries<2?n("div",{staticClass:"text-red-700 attention text-center"},[t._v("\n            Attention! 1 attempt to enter pincode left. Option is blocked\n          ")]):t._e(),t._v(" "),t.port.error?n("div",{staticClass:"text-red-700 attention text-center"},[t._v("\n            "+t._s(t.port.error)+"\n          ")]):t._e()])]):t._e()]),t._v(" "),n("div",{staticClass:"color h-4",style:{background:t.port.color?t.port.color.hex:"#ddd"}})]),t._v(" "),n("div",{staticClass:"hidden"},[t._v(t._s(t.answer)+" "+t._s(t.localAnswer))]),t._v(" "),n("v-dialog",{attrs:{persistent:"",width:"400"},model:{value:t.settingsDialog,callback:function(e){t.settingsDialog=e},expression:"settingsDialog"}},[n("v-card",[n("v-card-title",[t._v("Settings")]),t._v(" "),n("v-card-text",[n("div",{staticClass:"flex items-center mb-3"},[n("div",[t._v("Select color:")]),t._v(" "),n("div",[n("v-menu",{attrs:{top:"","nudge-bottom":"105","nudge-left":"16","close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on;return[n("div",t._g({staticClass:"port-color",style:{backgroundColor:t.color?t.color.hex:"#ddd"}},r))]}}]),model:{value:t.port.menu,callback:function(e){t.$set(t.port,"menu",e)},expression:"port.menu"}},[t._v(" "),n("v-card",[n("v-card-text",{staticClass:"pa-0"},[n("v-color-picker",{attrs:{flat:""},model:{value:t.color,callback:function(e){t.color=e},expression:"color"}})],1)],1)],1)],1)]),t._v(" "),n("div",[n("v-divider"),t._v(" "),n("v-checkbox",{staticClass:"mt-3",attrs:{label:"Anonymous call"},model:{value:t.isAnonymous,callback:function(e){t.isAnonymous=e},expression:"isAnonymous"}})],1)]),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"warn",text:""},on:{click:function(e){t.settingsDialog=!1}}},[t._v("\n          Cancel\n        ")]),t._v(" "),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){return t.saveSettings()}}},[t._v(" Save ")])],1)],1)],1),t._v(" "),n("v-dialog",{attrs:{width:"700"},model:{value:t.outputDialog,callback:function(e){t.outputDialog=e},expression:"outputDialog"}},[n("v-card",[n("v-card-title",[t._v("imei "+t._s(t.port.imei))]),t._v(" "),n("v-card-text",[n("div",{staticClass:"output-lg-wrap flex relative"},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-icon",t._g(t._b({staticClass:"fullscreen cursor-pointer top-2 right-2 z-20",attrs:{color:"white",dark:""},on:{click:function(e){t.outputDialog=!1}}},"v-icon",o,!1),r),[t._v("\n                mdi-fullscreen-exit")])]}}])},[t._v(" "),n("span",[t._v("exit fullscreen ")])]),t._v(" "),n("div",{staticClass:"relative w-full output-overflow-wrap"},[n("div"),t._v(" "),n("div",{staticClass:"output-lg w-full h-full bg-gray-400 z-10 rounded-md"},[n("div",{staticClass:"p-2 flex flex-col top-0 bg-gray-400 text-white pr-8"},t._l(t.port.answers,(function(e,r){return n("div",{key:r,staticClass:"mb-1"},[n("span",{style:{color:e.color?e.color:"white"}},[t._v(t._s(e.date)+t._s(e.text))])])})),0)])])],1)]),t._v(" "),n("v-divider"),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.outputDialog=!1}}},[t._v(" Ok ")])],1)],1)],1),t._v(" "),n("v-dialog",{attrs:{width:"700"},model:{value:t.messagesDialog,callback:function(e){t.messagesDialog=e},expression:"messagesDialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline grey lighten-2"},[t._v("\n        List of sms for imei: "+t._s(t.port.imei)+"\n      ")]),t._v(" "),n("v-card-text",[[n("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[n("thead",[n("tr",[n("th",{staticClass:"text-left"},[t._v("№")]),t._v(" "),n("th",{staticClass:"text-left"},[t._v("From")]),t._v(" "),n("th",{staticClass:"text-left"},[t._v("Text")]),t._v(" "),n("th",{staticClass:"text-left"},[t._v("Date")])])]),t._v(" "),n("tbody",t._l(t.port.smsList,(function(e,r){return n("tr",{key:e.timestamp},[n("td",[t._v(t._s(r+1))]),t._v(" "),n("td",[t._v(t._s(e.from))]),t._v(" "),n("td",[t._v(t._s(e.text))]),t._v(" "),n("td",[t._v(t._s(e.date))])])})),0)]},proxy:!0}])})]],2),t._v(" "),n("v-divider"),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.messagesDialog=!1}}},[t._v("\n          Ok\n        ")])],1)],1)],1)],1)}),[],!1,null,"4ddfffc0",null),N=component.exports;f()(component,{VBtn:h.a,VCard:_.a,VCardActions:k.a,VCardText:k.b,VCardTitle:k.c,VCheckbox:w.a,VColorPicker:x.a,VDialog:C.a,VDivider:S.a,VIcon:I.a,VMenu:y.a,VProgressLinear:P.a,VSelect:$.a,VSimpleTable:A.a,VSpacer:E.a,VTextField:R.a,VTooltip:D.a});var H={components:{Card:N},name:"cards-list",props:["ports","answer","imeis","disabledForAction"],data:function(){return{}},methods:{}},O=(n(585),Object(m.a)(H,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flex flex-wrap justify-center gap-7"},[t._l(t.ports,(function(e,r){return n("div",{key:r},[n("card",{attrs:{port:e,answer:t.answer,imeis:t.imeis,disabledForAction:t.disabledForAction},on:{"save-port":function(n){return t.$emit("saved-port",e)},"check-pin":function(n){return t.$emit("check-pin",e)},"attach-port":function(n){return t.$emit("attach-port",{imei:n,id:e.id})},"remove-window":function(n){return t.$emit("remove-window",e.id)},"unattach-port":function(n){return t.$emit("unattach-port",{imei:n,id:e.id})},"refresh-groups":function(n){return t.$emit("refresh-groups",e)},"ui-send-at":function(n){return t.$emit("ui-send-at",e)},"sms-list":function(n){return t.$emit("sms-list",e)},"check-balance":function(n){return t.$emit("check-balance",e)},"run-group":function(n){return t.$emit("run-group",{port:e,groupId:n.groupId,isSubgroup:n.isSubgroup})}}})],1)})),t._v(" "),n("div",{staticClass:"hidden"},[t._v("\n    "+t._s(t.answer)+"\n  ")])],2)}),[],!1,null,"527ae29a",null).exports),T=n(10),L=function(){function t(){Object(o.a)(this,t),this.chunks=""}return Object(c.a)(t,[{key:"transform",value:function(t,e){this.chunks+=t;var n=this.chunks.split("\r\n");this.chunks=n.pop(),n.forEach((function(line){return e.enqueue(line)}))}},{key:"flush",value:function(t){t.enqueue(this.chunks)}}]),t}(),j={asyncData:function(t){var e=localStorage.getItem("login"),n=JSON.parse(e);e&&-1!=[{username:"test",password:"123"},{username:"admin",password:"12345"}].findIndex((function(u){return u.username==(null==n?void 0:n.username)&&u.password==(null==n?void 0:n.password)}))?(t.store.commit("saveUsername",null==n?void 0:n.username),"12345"==(null==n?void 0:n.password)&&"admin"==(null==n?void 0:n.username)?t.store.commit("setIsAdmin",!0):(console.log=function(){},t.store.commit("setIsAdmin",!1))):$nuxt.$router.push("/login")},components:{CardsList:O},data:function(){return{uiPorts:[],ports:[],unattachedImeis:[],allDisabled:!1,closedPorts:[],answer:"",expectedImeisCount:0,isGsm7:!1,isPinDisable:!0,WINDOWS_LS_KEY:"windows",SETTINGS_LS_KEY:"settings",LOGIN_LS_KEY:"login",portsSpeed:115200}},mounted:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.syncUiPorts(),t.syncSettings(),t.checkPorts(),window.addEventListener("beforeunload",function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.ports.forEach(function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(p){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p.closed){e.next=3;break}return e.next=3,t.closePort(p);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.subscribeAtCommandResult(),t.subscribeCheckImei(),t.subscribeSimCardNumber(),t.subscribeCheckPin(),t.subscribeNetworkStatus(),t.subscribeBalanceAnswer(),t.subscribeElementResult(),t.subscribeAnswerToLog();case 12:case"end":return e.stop()}}),e)})))()},methods:{logout:function(){localStorage.removeItem(this.LOGIN_LS_KEY),$nuxt.$router.push("/login")},isImeisCountEqual:function(){var t=this.uiPorts.filter((function(u){return u.imei&&u.connected})).length,e=this.expectedImeisCount==t;return this.allDisabled=!e,e},attachPort:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o,c,l,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.imei,o=t.id,c=e.ports.find((function(p){return p.imei==r})),-1==(l=e.uiPorts.findIndex((function(t){return t.id==o})))){n.next=14;break}return-1!=(d=e.unattachedImeis.findIndex((function(i){return i==r})))&&e.unattachedImeis.splice(d,1),e.uiPorts[l].imei=r,e.saveWindow(e.uiPorts[l]),c&&(e.uiPorts[l]=c),e.uiPorts[l].id=o,n.next=13,e.$portsHelper.getGroups(c);case 13:c&&T.a.checkImei({imei:e.uiPorts[l].imei,answer:!0,port:e.uiPorts[l]});case 14:e.updateUI();case 15:case"end":return n.stop()}}),n)})))()},addWindow:function(){var t=Math.random();this.uiPorts.push({id:t,connected:!1}),this.addWindowToLocalStorage(t)},removeWindow:function(t){var e=this.uiPorts.findIndex((function(p){return p.id==t}));-1!=e&&(this.$portsHelper.resetPortProps(this.uiPorts[e]),this.uiPorts[e].imei&&(this.unattachedImeis.includes(this.uiPorts[e].imei)||this.unattachedImeis.push(this.uiPorts[e].imei)),this.uiPorts[e].connected=!1,this.uiPorts.splice(e,1),this.removeWindowFromLocalStorage(t),this.updateUI())},unattachPort:function(t){var e=t.imei,n=t.id,r=this.ports.find((function(p){return p.imei==e}));r&&this.$portsHelper.resetPortProps(r);var o=this.uiPorts.findIndex((function(p){return p.id==n}));-1!=o&&(this.unattachedImeis.includes(e)||this.unattachedImeis.push(e),this.uiPorts[o]={connected:!1,id:n},this.saveWindow(this.uiPorts[o])),this.updateUI()},refreshGroups:function(t){this.$portsHelper.getGroups(t),this.updateUI()},sendAtFromUi:function(t){this.$portsHelper.sendAtFromUi(t),this.updateUI()},listSms:function(t){this.$portsHelper.listSms(t),this.updateUI()},runGroup:function(data){this.$portsHelper.runGroup(data.port,data.groupId,data.isSubgroup),this.updateUI()},checkBalance:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.$portsHelper.checkBalance(t,e),this.updateUI()},savePort:function(t){this.$portsHelper.savePort(t),this.updateUI()},checkPinFromInput:function(t){this.$portsHelper.checkPinFromInput(t),this.updateUI()},connect:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("serial"in navigator)){e.next=11;break}return e.prev=1,e.next=4,navigator.serial.requestPort();case 4:return n=e.sent,e.next=7,t.openPort(n);case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:case"end":return e.stop()}}),e,null,[[1,9]])})))()},checkPorts:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.serial.getPorts();case 2:n=e.sent,console.log("ports: ",n),i=0;case 5:if(!(i<3)){e.next=15;break}if(0!=i){e.next=10;break}n.forEach(function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(p){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("".concat((new Date).toLocaleTimeString(),": port imei: "),p.imei),t.openPort(p);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=12;break;case 10:return e.next=12,t.openPortsWithTimeout(n);case 12:i++,e.next=5;break;case 15:case"end":return e.stop()}}),e)})))()},openPortsWithTimeout:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n){setTimeout((function(){t.forEach(function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(p){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("".concat((new Date).toLocaleTimeString(),": port imei with timeout: "),p.imei),e.openPort(p);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),n()}),5e3)})));case 1:case"end":return n.stop()}}),n)})))()},openPort:function(p){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,c,l,d,m,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,console.log("".concat((new Date).toLocaleTimeString(),": trying to open port imei: "),p.imei),p.imei||p.opened){e.next=48;break}return n={baudRate:t.portsSpeed?t.portsSpeed:115200,stopBits:1,parity:"none"},console.log("ports connection config: ",n),e.next=7,p.open(n);case 7:p.opened=!0,p.breakError=!1,p.closed=!1,p.textDecoder=new TextDecoderStream("utf-8"),p.readableStreamClosed=p.readable.pipeTo(p.textDecoder.writable),p.reader=p.textDecoder.readable.pipeThrough(new TransformStream(new L)).getReader(),p.writer=p.writable.getWriter(),t.$portsHelper.resetPortProps(p),t.$portsHelper.sendInitCommands(p),t.checkInitCommandsIfNeeded(p),p.keepReading=!0,e.prev=18;case 19:if(!p.keepReading||!p.readable){e.next=36;break}return p.pendingRead=p.reader.read(),setTimeout(Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p.imei||!p.pendingRead||p.closed){e.next=4;break}return console.log("closing port without imei: ",p,p.imei),e.next=4,t.closePort(p);case 4:case"end":return e.stop()}}),e)}))),6e4),e.next=24,p.pendingRead;case 24:if(o=e.sent,c=o.value,!o.done){e.next=29;break}return e.abrupt("break",36);case 29:l=c.toString().trim(),d=t.uiPorts.findIndex((function(t){return t.imei==p.imei})),console.log("value from port ".concat(p.imei,":"),l),(!p.imei||p.imei&&-1==d)&&t.$portsHelper.checkValueForATandSave(l,p),p.imei&&-1!=d?(p.connected=!0,t.updateUI(),p.currentElement&&"pending"==p.currentElement.status&&l&&(p.currentElement.logs||(p.currentElement.logs=[]),p.currentElement.logs.push({date:t.$moment(new Date).format(),type:"info",text:"value from device:  ".concat(l)})),t.$portsHelper.checkValueForATandSave(l,p),t.$portsHelper.checkValueForUssdAnswerAndSave(l,p),t.$portsHelper.checkValueForSmsAndSave(l,p),t.$portsHelper.checkValueForCallAnswerAndSave(l,p),t.$portsHelper.checkValueForSmsResultAndSave(l,p),t.$portsHelper.checkValueForNetworkStatus(l,p),t.$portsHelper.checkValueForSimFailure(l,p),t.$portsHelper.checkValueForPinResult(l,p,t.isPinDisable),t.$portsHelper.checkValueForSmsCenterNumber(l,p)):15==l.length&&/^\d+$/.test(l)&&!p.atFromUiPending&&(p.imei=l,p.connected=!0,p.isBalanceChecked=!1,p.networkFound=!1,p.searchingNetwork=!1,t.$portsHelper.resetPinCheckProps(p),p.loading=!1,t.$portsHelper.syncWithStorage(p),t.ports.push(p),-1!=(m=t.closedPorts.findIndex((function(i){return i.imei==p.imei})))&&t.closedPorts.splice(m,1),(v=t.uiPorts.find((function(t){return t.imei==p.imei})))?t.attachPort({id:v.id,imei:v.imei}):t.unattachedImeis.includes(p.imei)||t.unattachedImeis.push(p.imei),t.updateUI()),e.next=19;break;case 36:e.next=46;break;case 38:return e.prev=38,e.t0=e.catch(18),console.error("error while listening to the port (imei: ".concat(p.imei,"): "),e.t0,e.t0.name,e.t0.message,e.t0.code),T.a.answerToLog({imei:p.imei,answer:"Unexpected error: ".concat(e.t0.message),port:p,isError:!0,isSimLost:!1}),"BreakError"==e.t0.name&&(p.loading=!0,t.updateUI()),e.next=45,t.closePort(p);case 45:"BreakError"==e.t0.name&&(p.imei=null,console.log("closed port after break error: ",p),setTimeout(Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.checkPorts();case 1:case"end":return e.stop()}}),e)}))),500));case 46:return e.prev=46,e.finish(46);case 48:e.next=53;break;case 50:e.prev=50,e.t1=e.catch(0),console.error("error when trying to connect to the port: ",e.t1);case 53:case"end":return e.stop()}}),e,null,[[0,50],[18,38,46,48]])})))()},checkInitCommandsIfNeeded:function(p){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<5)){e.next=8;break}if(p.imei){e.next=5;break}return e.next=5,t.$portsHelper.sendInitCommandsWithTimeoutIfNoImei(p);case 5:n++,e.next=1;break;case 8:case"end":return e.stop()}}),e)})))()},closePort:function(p){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.connected=!1,p.opened=!1,p.closed=!0,t.$portsHelper.resetPortProps(p),p.simCardNumber=null,p.imei&&(t.closedPorts.push(p),-1!=(n=t.uiPorts.findIndex((function(i){return i.imei==p.imei})))&&(r=t.uiPorts[n].id,t.uiPorts[n]={connected:!1,id:r,imei:p.imei,loading:p.loading}),-1!=(o=t.ports.findIndex((function(i){return i.imei==p.imei})))&&t.ports.splice(o,1)),t.updateUI(),p.reader.cancel(),p.keepReading=!1,e.next=11,p.readableStreamClosed.catch((function(){}));case 11:return p.reader.releaseLock(),p.writer.releaseLock(),e.next=15,p.close();case 15:case"end":return e.stop()}}),e)})))()},runGroupAll:function(){var t=this;this.uiPorts.forEach((function(i){i.connected&&i.imei&&t.$portsHelper.runGroup(i,i.selectedGroupId)}))},checkBalanceAll:function(){var t=this;this.uiPorts.forEach((function(i){i.connected&&i.imei&&t.$portsHelper.checkBalance(i)}))},updateUI:function(){this.answer=Math.random()},saveSettings:function(){var t={portsSpeed:this.portsSpeed,expectedImeisCount:this.expectedImeisCount,isPinDisable:this.isPinDisable};localStorage.setItem(this.SETTINGS_LS_KEY,JSON.stringify(t))},syncSettings:function(){var t=localStorage.getItem(this.SETTINGS_LS_KEY);t&&(t=JSON.parse(t),this.portsSpeed=t.portsSpeed,this.expectedImeisCount=t.expectedImeisCount,this.isPinDisable=null!=t.isPinDisable?t.isPinDisable:this.isPinDisable,this.updateUI())},saveWindow:function(t){var e=localStorage.getItem(this.WINDOWS_LS_KEY);if(e){var n=(e=JSON.parse(e)).findIndex((function(e){return e.id==t.id}));-1!=n&&(t.imei?e[n]={id:t.id,connected:t.connected,imei:t.imei}:e[n]={id:t.id,connected:!1}),localStorage.setItem(this.WINDOWS_LS_KEY,JSON.stringify(e))}},addWindowToLocalStorage:function(t){var e=localStorage.getItem(this.WINDOWS_LS_KEY);e&&(e=JSON.parse(e)),e||(e=[]),e.push({id:t,connected:!1}),localStorage.setItem(this.WINDOWS_LS_KEY,JSON.stringify(e))},removeWindowFromLocalStorage:function(t){var e=localStorage.getItem(this.WINDOWS_LS_KEY);if(e){var n=(e=JSON.parse(e)).findIndex((function(e){return e.id==t}));-1!=n&&e.splice(n,1)}localStorage.setItem(this.WINDOWS_LS_KEY,JSON.stringify(e))},syncUiPorts:function(){var t=localStorage.getItem(this.WINDOWS_LS_KEY);t&&(this.uiPorts=JSON.parse(t))},subscribeAtCommandResult:function(){var t=this;this.atCommandResultSubscription=T.a.getAtCommandResult().subscribe(function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(n){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("res from command: ",n.data.port),n.data.port&&(o=n.data.port).commands&&(o.currentCommand.numberOfRepeatsDone++,o.currentCommand.repeatNumber==o.currentCommand.numberOfRepeatsDone&&(t.$portsHelper.performAfterCommandResultActions(o),o.commands.shift(),o.currentCommand=null),o.commands.length>0&&setTimeout(Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$runFirstCommandFromQueue(o);case 2:case"end":return e.stop()}}),e)}))),1e3));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},subscribeCheckImei:function(){var t=this;this.checkImeiSubscription=T.a.getCheckImei().subscribe((function(e){e.data.port&&setTimeout((function(){t.$portsHelper.checkSimCardNumber(e.data.port)}),500)}))},subscribeSimCardNumber:function(){var t=this;this.simCardNumberSubscription=T.a.getSimCardNumber().subscribe((function(e){e.data.port&&(console.log("simCard result: ",e.data),t.$portsHelper.checkPin(e.data.port),e.data.resetLogs&&(e.data.port.answers=[]))}))},subscribeCheckPin:function(){var t=this;this.checkPinSubscription=T.a.getCheckPin().subscribe((function(e){e.data.port&&(console.log("pin result: ",e.data),e.data.answer&&t.$portsHelper.checkNetworkRegistration(e.data.port))}))},subscribeNetworkStatus:function(){var t=this;this.networkStatusSubscription=T.a.getNetworkStatus().subscribe((function(e){e.data.answer?e.data.port.currentBalance||t.$portsHelper.checkBalance(e.data.port):!e.data.answer&&e.data.port.currentElement&&"pending"==e.data.port.currentElement.status&&(t.$portsHelper.endCurrentAndLeftElements(e.data.port,"skipped","network was not found"),t.updateUI())}))},subscribeBalanceAnswer:function(){var t=this;this.balanceAnswerSubscription=T.a.getBalanceAnswer().subscribe((function(e){if(e.data.port.isBalanceChecking)if(e.data.result){t.$portsHelper.addLog(e.data.port,{date:t.$portsHelper.currentTime(),text:e.data.answer,color:l.a.colors.greenDarkColor}),e.data.port.isBalanceChecking=!1;var n=e.data.port.providerGroups?e.data.port.providerGroups.find((function(g){return g.providerId==e.data.port.selectedProviderId})):null,r=e.data.port.currentElement&&e.data.port.groupPending?e.data.port.currentElement.balanceValueRegExpr:n.balanceValueRegExpr,o=e.data.answer.match(r);if(console.log("balance regex result: ",o),!(o&&o.length>1))return;var c=void 0,d=o[0].split(" ");d&&d.length>0&&(console.log("balance num value: ",d[0]),c=d[0].replace(",",".")),console.log("pre num balance: ",c);var m=Number(c);if(e.data.port.currentBalanceNum=m,e.data.port.currentBalance=o[0],t.updateUI(),console.log("current balance num: ",e.data.port.currentBalanceNum),!e.data.port.isBalanceChecked&&e.data.port.isAutoRunGroup&&t.$portsHelper.runCurrentGroupIfAllowed(e.data.port),e.data.port.isBalanceChecked=!0,e.data.port.currentElement&&e.data.port.currentElement.isChangesBalance)if(null==e.data.port.prevBalance){var v=e.data.port.maxBalance?e.data.port.maxBalance.replace(",","."):null;if("pin"==e.data.port.currentElement.elementType&&null!=e.data.port.currentBalanceNum&&v&&e.data.port.currentBalanceNum+e.data.port.currentElement.balanceIncrement>+v){t.$portsHelper.endCurrentAndLeftElements(e.data.port,"skipped","Operation is not allowed! Balance will be out of limit!"),t.updateUI()}else e.data.port.prevBalance=e.data.answer,t.$portsHelper.runElement(e.data.port,e.data.port.currentElement)}else e.data.answer!=e.data.port.prevBalance?(e.data.port.currentElement.status="success",e.data.port.currentElement.message=e.data.answer,t.$portsHelper.updateGroupElementStatus(e.data.port,e.data.port.currentElement),t.updateUI(),t.$portsHelper.reportElement(e.data.port,e.data.port.currentElement)):(t.$portsHelper.endCurrentAndLeftElements(e.data.port,"failure","balance not changed"),t.updateUI());else t.$portsHelper.operationCompleteLog(e.data.port)}else e.data.port.isBalanceChecking=!1,e.data.port.currentBalance=null,e.data.port.currentBalanceNum=null,t.$portsHelper.errorLog(e.data.port,e.data.answer),t.updateUI(),e.data.port.currentElement&&e.data.port.currentElement.isChangesBalance?(t.$portsHelper.endCurrentAndLeftElements(e.data.port,"failure","error in checking balance: ".concat(e.data.answer)),t.updateUI()):t.$portsHelper.operationCompleteLog(e.data.port)}))},subscribeElementResult:function(){var t=this;this.elementResultSubscription=T.a.getElementResult().subscribe((function(e){if(e.data.port.currentElement&&e.data.port.currentElement.isChangesBalance&&e.data.answer){t.$portsHelper.addLog(e.data.port,{date:t.$portsHelper.currentTime(),text:t.$portsHelper.getAnswerByElemet(e.data.port.currentElement,!1),color:l.a.colors.greenDarkColor});var n=+e.data.port.currentElement.pause>0?1e3*+e.data.port.currentElement.pause:0;setTimeout((function(){t.$portsHelper.checkBalance(e.data.port,!0)}),n)}else if(e.data.answer&&e.data.port.currentElement){var r=+e.data.port.currentElement.pause>0?1e3*+e.data.port.currentElement.pause:0;setTimeout((function(){t.$portsHelper.reportElement(e.data.port,e.data.port.currentElement)}),r)}else!e.data.answer&&e.data.port.currentElement&&(t.$portsHelper.endCurrentAndLeftElements(e.data.port,"","",!1),t.updateUI())}))},subscribeAnswerToLog:function(){var t=this;this.answerToLogSubscription=T.a.getAnswerToLog().subscribe((function(e){if(e.data.isError){if(t.$portsHelper.errorLog(e.data.port,e.data.answer),!e.data.isKeepGroupPending&&(e.data.port.currentGroup=null,e.data.port.groupPending&&e.data.port.currentElements)){var n=e.data.isSimLost?"sim lost during execution the group":"unexpected error or device connection lost during execution the group";t.$portsHelper.endLeftElements(e.data.port,"skipped",n),e.data.port.currentGroup=null,t.$portsHelper.refreshCurrentGroup(e.data.port)}}else t.$portsHelper.addLog(e.data.port,{date:t.$portsHelper.currentTime(),text:e.data.answer,color:l.a.colors.greenDarkColor})}))}},computed:{isAdmin:function(){return this.$store.state.isAdmin},username:function(){return this.$store.state.username}},beforeDestroy:function(){var t=this;this.uiPorts.forEach((function(i){i.connected&&i.imei&&t.$portsHelper.endElementsIfConnectionsLost(i)})),this.checkImeiSubscription.unsubscribe(),this.simCardNumberSubscription.unsubscribe(),this.checkPinSubscription.unsubscribe(),this.atCommandResultSubscription.unsubscribe(),this.balanceAnswerSubscription.unsubscribe(),this.networkStatusSubscription.unsubscribe(),this.elementResultSubscription.unsubscribe(),this.answerToLogSubscription.unsubscribe()}},G=(n(587),n(618)),B=n(616),V=n(599),U=Object(m.a)(j,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-app-bar",{attrs:{color:"primary",dark:""}},[n("v-toolbar-title",[t._v("Sim Activator")]),t._v(" "),n("v-spacer"),t._v(" "),n("div",[n("div",{staticClass:"flex items-center"},[n("div",{staticClass:"mr-3"},[n("div",[t._v(t._s(t.username))]),t._v(" "),n("div",{staticClass:"underline cursor-pointer",on:{click:function(e){return t.logout()}}},[t._v("logout")])]),t._v(" "),n("div",{staticClass:"\n            avatar\n            bg-gray-100\n            shadow-md\n            rounded-full\n            p-1\n            flex\n            justify-center\n            items-center\n            cursor-pointer\n          "},[n("v-icon",{staticClass:"w-7 h-7",attrs:{color:"grey lighten-1",dark:""}},[t._v("\n            mdi-account")])],1)])])],1),t._v(" "),n("div",{staticClass:"flex justify-between items-baseline p-5"},[n("div",[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-btn",t._g(t._b({staticClass:"mb-2 mr-2",attrs:{color:"accent"},on:{click:function(e){return t.connect()}}},"v-btn",o,!1),r),[t._v("add new port")])]}}])},[t._v(" "),n("span",[t._v("Open a browser window to select a single serial port ")])]),t._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-btn",t._g(t._b({staticClass:"mb-2",attrs:{color:"accent"},on:{click:function(e){return t.checkPorts()}}},"v-btn",o,!1),r),[t._v("refresh")])]}}])},[t._v(" "),n("span",[t._v("Refresh a list of already connected ports")])]),t._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-btn",t._g(t._b({staticClass:"mb-2 mr-2",attrs:{color:"accent",disabled:t.allDisabled},on:{click:function(e){return t.checkBalanceAll()}}},"v-btn",o,!1),r),[t._v("check balance all")])]}}])},[t._v(" "),n("span",[t._v("Check balance in all connected ports, if there is no pending\n          operations in port (group running, balance checking etc. )")])]),t._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-btn",t._g(t._b({staticClass:"mb-2 mr-2",attrs:{color:"accent",disabled:t.allDisabled},on:{click:function(e){return t.runGroupAll()}}},"v-btn",o,!1),r),[t._v("run group all")])]}}])},[t._v(" "),n("span",[t._v("Run selected group in all connected ports, if there are no pending\n          operations in port (group running, balance checking etc. )")])]),t._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-btn",t._g(t._b({staticClass:"mb-2 mr-2",attrs:{color:"primary"},on:{click:function(e){return t.addWindow()}}},"v-btn",o,!1),r),[t._v("+ add new window")])]}}])},[t._v(" "),n("span",[t._v("Add new empty window to work with")])])],1),t._v(" "),n("div",[n("div",{staticClass:"mb-3"},[t._m(0),t._v(" "),t._l(t.unattachedImeis,(function(e,r){return n("div",{key:r},[t._v("\n          "+t._s(e)+"\n        ")])}))],2),t._v(" "),n("v-divider"),t._v(" "),t.closedPorts&&0!=t.closedPorts.length?n("div",[n("b",[t._v("Closed ports imeis:")])]):t._e(),t._v(" "),t._l(t.closedPorts,(function(e,r){return n("div",{key:r},[t._v("\n        "+t._s(e.imei)+"\n      ")])}))],2)]),t._v(" "),n("div",{staticClass:"flex items-center justify-start mx-5 mb-3 gap-4"},[n("v-text-field",{staticClass:"speed-input",attrs:{label:"ports connection speed",disabled:!0},on:{change:function(e){return t.saveSettings()}},model:{value:t.portsSpeed,callback:function(e){t.portsSpeed=e},expression:"portsSpeed"}}),t._v(" "),n("v-text-field",{staticClass:"count-input",attrs:{type:"number",label:"input expected connected imeis count"},on:{change:function(e){return t.saveSettings()}},model:{value:t.expectedImeisCount,callback:function(e){t.expectedImeisCount=e},expression:"expectedImeisCount"}}),t._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-icon",t._g(t._b({staticClass:"cursor-pointer",attrs:{color:"accent",dark:"",large:""}},"v-icon",o,!1),r),[t._v("\n          mdi-information")])]}}])},[t._v(" "),n("span",[t._v("Input the number of imeis that you connect and attach to windows.\n        This value is critial bacause sometimes some imeis are not connected\n        for the first time the page is loaded or there can be some break\n        conditions from device that occasionally happen.\n      ")])]),t._v(" "),t.isAdmin?n("div",[n("v-checkbox",{attrs:{label:"disable pin requirement after pin is ready"},on:{change:function(e){return t.saveSettings()}},model:{value:t.isPinDisable,callback:function(e){t.isPinDisable=e},expression:"isPinDisable"}})],1):t._e(),t._v(" "),t.isImeisCountEqual()?t._e():n("div",[n("v-alert",{staticClass:"w-full",attrs:{type:"error"}},[t._v("\n        Attention! The number of connected imeis attached to windows is not\n        equals to expected connected imeis count! Attach all connected imeis\n        to windows or try to refresh this page until you get all imeis\n        connected.")])],1)],1),t._v(" "),n("div",{staticClass:"px-5 mb-4"},[n("cards-list",{attrs:{ports:t.uiPorts,answer:t.answer,imeis:t.unattachedImeis,disabledForAction:t.allDisabled},on:{"saved-port":function(e){return t.savePort(e)},"check-pin":function(e){return t.checkPinFromInput(e)},"attach-port":function(e){return t.attachPort(e)},"remove-window":function(e){return t.removeWindow(e)},"unattach-port":function(e){return t.unattachPort(e)},"refresh-groups":function(e){return t.refreshGroups(e)},"ui-send-at":function(e){return t.sendAtFromUi(e)},"sms-list":function(e){return t.smsList(e)},"check-balance":function(e){return t.checkBalance(e)},"run-group":function(e){return t.runGroup(e)}}}),t._v(" "),n("div",{staticClass:"hidden"},[t._v("\n      "+t._s(t.answer)+"\n    ")])],1)],1)}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b",[t._v("Unattached imeis:")])])}],!1,null,"3f7bea02",null);e.default=U.exports;f()(U,{VAlert:G.a,VAppBar:B.a,VBtn:h.a,VCheckbox:w.a,VDivider:S.a,VIcon:I.a,VSpacer:E.a,VTextField:R.a,VToolbarTitle:V.a,VTooltip:D.a})}}]);