(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{486:function(e,t,r){var content=r(561);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(51).default)("3485bd00",content,!0,{sourceMap:!1})},560:function(e,t,r){"use strict";r(486)},561:function(e,t,r){var n=r(50)((function(i){return i[1]}));n.push([e.i,'.port-color[data-v-369c9fea]{\n  cursor:"pointer";\n  height:30px;\n  width:30px;\n  margin-left:10px;\n  border-radius:4px;\n  transition:border-radius .2s ease-in-out;\n  margin-right:10px\n}\n.imei-input[data-v-369c9fea]{\n  max-width:300px\n}\n.count-input[data-v-369c9fea]{\n  max-width:100px\n}\n.imei-row[data-v-369c9fea],.test-row[data-v-369c9fea]{\n  display:flex;\n  align-items:center;\n  justify-content:flex-start;\n  gap:12px\n}\n.hide[data-v-369c9fea]{\n  display:none\n}',""]),n.locals={},e.exports=n},615:function(e,t,r){"use strict";r.r(t);var n=r(1),o=r(9),c=r(21),l=(r(40),r(62),r(15),r(52),r(53),r(39),r(129),r(61),r(60),r(119),function(){function e(){Object(o.a)(this,e),this.chunks=""}return Object(c.a)(e,[{key:"transform",value:function(e,t){this.chunks+=e;var r=this.chunks.split("\r\n");this.chunks=r.pop(),r.forEach((function(line){return t.enqueue(line)}))}},{key:"flush",value:function(e){e.enqueue(this.chunks)}}]),e}()),m={data:function(){return{imeis:[],imeiToAdd:{},test1Count:1,test2Count:1,defaultColor:"#000",enc:new TextEncoder("utf-8"),restartFirstCommand:"AT+CFUN=1,1",restartSecondCommand:"AT^RESET",checkSimCardCommand:"AT^ICCID?",checkImeiCommand:"AT+CGSN",atiCommand:"ATI",ateCommand:"ATE",logs:[],answer:""}},mounted:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.initAddImei();case 1:case"end":return t.stop()}}),t)})))()},methods:{initAddImei:function(){this.imeiToAdd=Object.assign(this.imeiToAdd,{imei:null,color:{hex:this.defaultColor}})},addImei:function(e){e.imei=e.imei.trim().toString(),this.imeis.push(Object.assign({},e)),this.initAddImei()},removeImei:function(e){this.imeis.splice(e,1)},connect:function(){return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("serial"in navigator)){e.next=8;break}return e.prev=1,e.next=4,navigator.serial.requestPort();case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),e,null,[[1,6]])})))()},test:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,o,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=0,r.t0=e,r.next=1===r.t0?4:2===r.t0?6:8;break;case 4:return n=t.test1Count,r.abrupt("break",8);case 6:return n=t.test2Count,r.abrupt("break",8);case 8:o=regeneratorRuntime.mark((function r(i){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(0!=i){r.next=4;break}t.imeis.forEach((function(r){t.testOne(r,e,i+1)})),r.next=6;break;case 4:return r.next=6,t.testAsync(e,i+1);case 6:case"end":return r.stop()}}),r)})),i=0;case 10:if(!(i<n)){r.next=15;break}return r.delegateYield(o(i),"t1",12);case 12:i++,r.next=10;break;case 15:case"end":return r.stop()}}),r)})))()},testAsync:function(e,i){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise(function(){var r=Object(n.a)(regeneratorRuntime.mark((function r(n){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:setTimeout((function(){t.imeis.forEach((function(r){t.testOne(r,e,i)})),n()}),5e3);case 1:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()));case 1:case"end":return r.stop()}}),r)})))()},testOne:function(e,t,i){var r=this;return Object(n.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.log("-------------------------------------------",e.color.hex),r.log("ports requested (count ".concat(i,") ..."),e.color.hex),n.next=4,navigator.serial.getPorts();case 4:o=n.sent,r.log("ports count: "+o.length,e.color.hex),console.log("ports: ",o),o.forEach((function(p){r.openPort(p,e,t)}));case 8:case"end":return n.stop()}}),n)})))()},openPort:function(p,e,t){var r=this;return Object(n.a)(regeneratorRuntime.mark((function o(){var c;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(o.prev=0,p.imei){o.next=31;break}return o.next=4,p.open({baudRate:9600,stopBits:1,parity:"none"});case 4:return p.textDecoder=new TextDecoderStream,p.readableStreamClosed=p.readable.pipeTo(p.textDecoder.writable),p.reader=p.textDecoder.readable.pipeThrough(new TransformStream(new l)).getReader(),p.writer=p.writable.getWriter(),o.next=10,p.writer.write(r.enc.encode("".concat(r.ateCommand,"\r\n")));case 10:setTimeout(Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.writer.write(r.enc.encode("".concat(r.checkImeiCommand,"\r\n")));case 2:case"end":return e.stop()}}),e)}))),1e3),r.log("imei requested...",e.color.hex),p.keepReading=!0,o.prev=13,c=regeneratorRuntime.mark((function e(){var o,c,l,m,d,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.pendingRead=p.reader.read(),setTimeout(Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p.imei||!p.pendingRead){e.next=4;break}return console.log("closing port without imei: ",p,p.imei),e.next=4,r.closePort(p);case 4:case"end":return e.stop()}}),e)}))),1e4),e.next=4,p.pendingRead;case 4:if(o=e.sent,c=o.value,!o.done){e.next=9;break}return e.abrupt("return","break");case 9:if(l=c.toString().trim(),m=c.trim().toString(),console.log("value from port ".concat(p.imei,":"),l),p.imei||15!=l.length||!/^\d+$/.test(l)){e.next=17;break}(d=r.imeis.find((function(i){return i.imei==l})))&&l==d.imei&&(r.log("imei found: ".concat(l),d.color.hex),p.imei=l,setTimeout(Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.lastAt=r.atiCommand,e.next=3,p.writer.write(r.enc.encode("".concat(p.lastAt,"\r\n")));case 3:r.log("ATI command send from port (".concat(p.imei,"):"),d.color.hex);case 4:case"end":return e.stop()}}),e)}))),1e3)),e.next=27;break;case 17:if(!p.imei){e.next=27;break}if(!(f=r.imeis.find((function(i){return i.imei==p.imei})))){e.next=27;break}e.t0=t,e.next=1===e.t0?23:2===e.t0?25:27;break;case 23:return r.checkValueForATtest1(m,p,f),e.abrupt("break",27);case 25:return r.checkValueForATtest2(m,p,f),e.abrupt("break",27);case 27:case"end":return e.stop()}}),e)}));case 15:if(!p.keepReading){o.next=22;break}return o.delegateYield(c(),"t0",17);case 17:if("break"!==o.t0){o.next=20;break}return o.abrupt("break",22);case 20:o.next=15;break;case 22:o.next=29;break;case 24:return o.prev=24,o.t1=o.catch(13),console.error("error while listening to the port (imei: ".concat(p.imei,"): "),o.t1),o.next=29,r.closePort(p);case 29:return o.prev=29,o.finish(29);case 31:o.next=36;break;case 33:o.prev=33,o.t2=o.catch(0),console.error("error when trying to connect to the port: ",o.t2);case 36:case"end":return o.stop()}}),o,null,[[0,33],[13,24,29,31]])})))()},checkValueForATtest1:function(e,t,r){var o=this;return Object(n.a)(regeneratorRuntime.mark((function c(){return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:console.log("port lastAt: ",t.lastAt),t.lastAt&&e==t.lastAt?(t.prevAnswer=e,t.currentAnswer=""):t.prevAnswer&&t.prevAnswer==t.lastAt&&"OK"!=e?t.currentAnswer+=e:t.prevAnswer&&t.prevAnswer==t.lastAt&&"OK"==e&&(console.log("prev answer: ",t.prevAnswer),t.currentAnswer+=e,console.log("current answer: ",t.currentAnswer),t.prevAnswer.includes(o.atiCommand)&&(o.log("ATI command result from port (".concat(t.imei,"): ").concat(t.currentAnswer),r.color.hex),setTimeout(Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.restart(t,r);case 1:case"end":return e.stop()}}),e)}))),1e3),o.answer="update5"),t.imei&&(t.lastAt="",t.prevAnswer="",o.answer="atNotPending"));case 2:case"end":return c.stop()}}),c)})))()},checkValueForATtest2:function(e,t,r){var o=this;return Object(n.a)(regeneratorRuntime.mark((function c(){return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:console.log("port lastAt: ",t.lastAt),t.lastAt&&e==t.lastAt?(t.prevAnswer=e,t.currentAnswer=""):t.prevAnswer&&t.prevAnswer==t.lastAt&&"OK"!=e?t.currentAnswer+=e:t.prevAnswer&&t.prevAnswer==t.lastAt&&"OK"==e&&(console.log("prev answer: ",t.prevAnswer),t.currentAnswer+=e,console.log("current answer: ",t.currentAnswer),t.prevAnswer.includes(o.atiCommand)?(o.log("ATI command result from port (".concat(t.imei,"): ").concat(t.currentAnswer),r.color.hex),setTimeout(Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.lastAt=o.checkSimCardCommand,e.next=3,t.writer.write(o.enc.encode("".concat(t.lastAt,"\r\n")));case 3:o.log("Sim card requested with command ".concat(o.checkSimCardCommand," from port (").concat(t.imei,")..."),r.color.hex),o.answer="update5";case 5:case"end":return e.stop()}}),e)}))),1e3)):t.prevAnswer.includes(o.checkSimCardCommand)&&(o.log("SimCard command result from port (".concat(t.imei,"): ").concat(t.currentAnswer),r.color.hex),setTimeout(Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.restart(t,r);case 1:case"end":return e.stop()}}),e)}))),1e3),o.answer="update5"),t.imei&&(t.lastAt="",t.prevAnswer="",o.answer="atNotPending"));case 2:case"end":return c.stop()}}),c)})))()},restart:function(e,t){var r=this;return Object(n.a)(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return e.lastAt=r.restartFirstCommand,o.next=3,e.writer.write(r.enc.encode("".concat(e.lastAt,"\r\n")));case 3:r.log("Port (".concat(e.imei,") restart first command started ").concat(r.restartFirstCommand,"..."),t.color.hex),setTimeout(Object(n.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.lastAt=r.restartSecondCommand,r.answer="atPending3",n.next=4,e.writer.write(r.enc.encode("".concat(e.lastAt,"\r\n")));case 4:r.log("Port (".concat(e.imei,") restart second command started ").concat(r.restartSecondCommand,"..."),t.color.hex);case 5:case"end":return n.stop()}}),n)}))),500);case 5:case"end":return o.stop()}}),o)})))()},closePort:function(p){return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.reader.cancel(),p.keepReading=!1,e.next=4,p.readableStreamClosed.catch((function(){}));case 4:p.reader.releaseLock(),p.writer.releaseLock(),p.close(),console.log("port closed: ",p);case 8:case"end":return e.stop()}}),e)})))()},log:function(text,e){this.logs.push({time:(new Date).toLocaleTimeString(),text:text,color:e})},refreshLogs:function(){this.logs=[]}}},d=(r(560),r(63)),f=r(130),v=r.n(f),w=r(491),h=r(474),x=r(429),k=r(612),A=r(482),C=r(483),R=r(600),component=Object(d.a)(m,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"p-3"},[r("v-btn",{staticClass:"my-3",attrs:{color:"primary"},on:{click:function(t){return e.connect()}}},[e._v("Connect ports")]),e._v(" "),r("v-divider"),e._v(" "),e._l(e.imeis,(function(t,n){return r("div",{key:n,staticClass:"imei-row"},[r("div",[r("v-text-field",{staticClass:"ml-2 imei-input",attrs:{label:"imei"},model:{value:t.imei,callback:function(r){e.$set(t,"imei",r)},expression:"imei.imei"}})],1),e._v(" "),r("div",[r("div",[r("v-menu",{attrs:{top:"","nudge-bottom":"105","nudge-left":"16","close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function(n){var o=n.on;return[r("div",e._g({staticClass:"port-color",style:{backgroundColor:t.color?t.color.hex:e.defaultColor}},o))]}}],null,!0),model:{value:t.menu,callback:function(r){e.$set(t,"menu",r)},expression:"imei.menu"}},[e._v(" "),r("v-card",[r("v-card-text",{staticClass:"pa-0"},[r("v-color-picker",{attrs:{flat:""},model:{value:t.color,callback:function(r){e.$set(t,"color",r)},expression:"imei.color"}})],1)],1)],1)],1)]),e._v(" "),r("v-btn",{attrs:{color:"accent"},on:{click:function(t){return e.removeImei(n)}}},[e._v("remove")])],1)})),e._v(" "),r("div",{staticClass:"imei-row"},[r("div",[r("v-text-field",{staticClass:"ml-2 imei-input",attrs:{label:"imei"},on:{change:function(t){e.answer=e.imeiToAdd.imei}},model:{value:e.imeiToAdd.imei,callback:function(t){e.$set(e.imeiToAdd,"imei",t)},expression:"imeiToAdd.imei"}})],1),e._v(" "),r("div",[r("div",[r("v-menu",{attrs:{top:"","nudge-bottom":"105","nudge-left":"16","close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[r("div",e._g({staticClass:"port-color",style:{backgroundColor:e.imeiToAdd.color?e.imeiToAdd.color.hex:e.defaultColor}},n))]}}]),model:{value:e.imeiToAdd.menu,callback:function(t){e.$set(e.imeiToAdd,"menu",t)},expression:"imeiToAdd.menu"}},[e._v(" "),r("v-card",[r("v-card-text",{staticClass:"pa-0"},[r("v-color-picker",{attrs:{flat:""},model:{value:e.imeiToAdd.color,callback:function(t){e.$set(e.imeiToAdd,"color",t)},expression:"imeiToAdd.color"}})],1)],1)],1)],1)]),e._v(" "),r("v-btn",{attrs:{disabled:!e.imeiToAdd.imei,color:"accent"},on:{click:function(t){return e.addImei(e.imeiToAdd)}}},[e._v("add imei")])],1),e._v(" "),r("v-divider"),e._v(" "),r("div",{staticClass:"test-row"},[r("v-text-field",{staticClass:"ml-2 count-input",attrs:{type:"number",label:"test1 count"},model:{value:e.test1Count,callback:function(t){e.test1Count=t},expression:"test1Count"}}),e._v(" "),r("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.test(1)}}},[e._v("run test 1")])],1),e._v(" "),r("div",{staticClass:"test-row"},[r("v-text-field",{staticClass:"ml-2 count-input",attrs:{type:"number",label:"test2 count"},model:{value:e.test2Count,callback:function(t){e.test2Count=t},expression:"test2Count"}}),e._v(" "),r("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.test(2)}}},[e._v("run test 2")])],1),e._v(" "),r("v-divider"),e._v(" "),r("div",{staticClass:"flex justify-between items-center py-2"},[e._m(0),e._v(" "),r("v-btn",{staticClass:"ml-3",attrs:{color:"accent"},on:{click:function(t){return e.refreshLogs()}}},[e._v("\n      Refresh logs")])],1),e._v(" "),r("v-divider"),e._v(" "),r("div",{staticClass:"logs"},e._l(e.logs,(function(t,n){return r("div",{key:n,staticClass:"log-row mb-1",style:{color:t.color}},[r("span",[e._v(" "+e._s(t.time)+": ")]),e._v(" "),r("span",[e._v(" "+e._s(t.text)+" ")])])})),0),e._v(" "),r("div",{staticClass:"hide"},[e._v("\n    "+e._s(e.answer)+"\n  ")])],2)}),[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b",[e._v("LOGS:")])])}],!1,null,"369c9fea",null);t.default=component.exports;v()(component,{VBtn:w.a,VCard:h.a,VCardText:x.b,VColorPicker:k.a,VDivider:A.a,VMenu:C.a,VTextField:R.a})}}]);